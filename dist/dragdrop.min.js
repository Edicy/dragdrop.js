/*! Drag & Drop library - v - 2014-08-22
* Copyright (c) 2014 Priit Haamer; Licensed  */
!function(a){"use strict";var b=function(a,b){this.el=a,this.options=b,this.init()};b.prototype={init:function(){var a=this.options.handle?this.el.querySelector(this.options.handle):this.el;this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.handleTouchCancel=this.handleTouchCancel.bind(this),a.addEventListener("touchmove",this.handleTouchMove),a.addEventListener("touchend",this.handleTouchEnd),a.addEventListener("touchcancel",this.handleTouchCancel),a.addEventListener("mousedown",this.handleMouseDown)},handleMouseDown:function(b){1===b.which&&(b.preventDefault(),b.stopPropagation(),a.addEventListener("mousemove",this.handleMouseMove),a.addEventListener("mouseup",this.handleMouseUp))},handleMouseMove:function(b){b.stopPropagation(),this.dragging||(this.dragging=!0,this.dragStart(b)),this.dragging&&a.requestAnimationFrame(function(){this.drag(b)}.bind(this))},handleMouseUp:function(b){a.removeEventListener("mousemove",this.handleMouseMove),a.removeEventListener("mouseup",this.handleMouseUp),this.dragging&&(this.dragStop(b),this.dragging=!1)},dragStart:function(b){var c=this.el.getBoundingClientRect(),d={top:parseInt(c.top+a.scrollY,10),left:parseInt(c.left+a.scrollX,10)};this.offsetDelta={top:Math.abs(b.pageY-d.top),left:Math.abs(b.pageX-d.left)},this.helper=this.getHelper(),this.helper&&(this.helper.style.pointerEvents="none",this.helper.style.position="absolute",this.helper.style.zIndex=99999,this.helper.style.top=b.pageY-this.offsetDelta.top,this.helper.style.left=b.pageX-this.offsetDelta.left,document.body.appendChild(this.helper)),this.fillDroppableCache()},getHelper:function(){return this.options.helper()},getDroppables:function(){return document.querySelectorAll("[data-droppable]")},fillDroppableCache:function(){this.droppableCache=[];for(var a=this.getDroppables(),b=0;b<a.length;b++)this.droppableCache.push({rect:a[b].getBoundingClientRect(),el:a[b]})},releaseDroppableCache:function(){this.droppableCache=[]},getClosestElement:function(b,c,d,e){for(var f=0,g=this.droppableCache.length;g>f;f++){var h=this.droppableCache[f].rect,i=h.left+a.scrollX,j=h.top+a.scrollY,k=h.width,l=h.height;if(!(i>b+d||b>i+k||j>c+e||c>j+l))return this.droppableCache[f].el}return null},drag:function(a){if(this.helper){this.helper.style.top=a.pageY-this.offsetDelta.top,this.helper.style.left=a.pageX-this.offsetDelta.left;var b=this.getClosestElement(a.pageX-this.offsetDelta.left,a.pageY-this.offsetDelta.top,this.helper.clientWidth,this.helper.clientHeight);if(b){var c=new CustomEvent("draggable:dragover",{});b.dispatchEvent(c)}}},dragStop:function(){this.helper&&this.helper.remove(),this.helper=null,this.releaseDroppableCache()},handleTouchMove:function(b){if(b.targetTouches.length>0){var c=b.targetTouches[0];b.preventDefault(),this.lastTouch||this.dragStart(c),this.lastTouch=c,a.requestAnimationFrame(function(){this.drag(b)}.bind(this))}},handleTouchEnd:function(){this.lastTouch&&(this.dragStop(this.lastTouch),this.lastTouch=null)},handleTouchCancel:function(){this.lastTouch&&(this.dragStop(this.lastTouch),this.lastTouch=null)}},a.draggable=function(a,c){for(var d=0;d<a.length;d++)new b(a[d],c)}}(this),function(a){"use strict";var b=function(a,b){this.el=a,this.options=b,this.init()};b.prototype={init:function(){this.handleDragOverEvent=this.handleDragOverEvent.bind(this),this.el.setAttribute("data-droppable",!0),this.el.addEventListener("draggable:dragover",this.handleDragOverEvent)},handleDragOverEvent:function(){}},a.droppable=function(a,c){for(var d=0;d<a.length;d++)new b(a[d],c)}}(this);